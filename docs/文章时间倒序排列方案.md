# RSS 文章时间倒序排列方案

## 📅 实施日期

2026-02-07

## 🎯 需求

在 Obsidian 文件夹中让 RSS 文章按发布时间倒序排列，最新文章在最前面。

## ✅ 已实施方案：文件名日期前缀

### 实现原理

在创建文件时，自动在文件名前添加 `YYYY-MM-DD` 格式的日期前缀。这样文件在按字母顺序排列时，自动就是按时间倒序（最新的日期最大，排在前面）。

### 核心代码

```typescript
// Extract and format date for filename prefix
let datePrefix = "";
try {
    // Try to get date from isoDate or pubDate
    const dateStr = item.isoDate || item.pubDate;
    if (dateStr) {
        const date = new Date(dateStr);
        // Format as YYYY-MM-DD
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        datePrefix = `${year}-${month}-${day} `;
    }
} catch (e) {
    console.warn("Simple RSS: Could not parse date for item", e);
}

const filePath = normalizePath(path + "/" + datePrefix + sanitizedTitle + ".md");
```

### 文件名示例

**修改前**:

```
Why I Joined OpenAI.md
WebView performance significantly slower than PWA.md
Introducing the Developer Knowledge API.md
```

**修改后**:

```
2026-02-07 Why I Joined OpenAI.md
2026-02-06 WebView performance significantly slower than PWA.md
2026-02-05 Introducing the Developer Knowledge API.md
```

### 在 Obsidian 中的显示效果

在文件浏览器中，文件会自动按日期倒序排列：

```
📁 深度科技与极客文化/
  📄 2026-02-07 Why I Joined OpenAI.md
  📄 2026-02-07 WebView performance significantly slower.md
  📄 2026-02-06 Introducing the Developer Knowledge API.md
  📄 2026-02-05 Show HN R3forth.md
  📄 2026-02-04 OpenCiv3 reimagining of Civilization III.md
```

## 🔍 技术细节

### 日期来源优先级

1. **item.isoDate** - ISO 8601 格式日期（首选）
2. **item.pubDate** - RSS 标准发布日期（备选）

### 日期格式

- **格式**: `YYYY-MM-DD` (带尾随空格)
- **示例**: `2026-02-07`
- **为什么加空格**: 让标题与日期在视觉上分离

### 错误处理

- 如果无法解析日期，则不添加前缀
- 文件正常创建，只是没有日期前缀
- 错误会在控制台显示警告

### 文件名清理

日期前缀添加在标题清理之**后**，确保文件名符合系统规范。

## 📊 优势对比

| 方案 | 自动排序 | 文件名简洁 | 兼容性 | 实现难度 |
|------|---------|-----------|--------|---------|
| **日期前缀** ⭐ | ✅ | ⚠️ 较长 | ✅ 高 | ⭐ 简单 |
| YAML + Dataview | ✅ | ✅ | ⚠️ 需插件 | ⭐⭐⭐ 复杂 |
| 日期文件夹 | ⚠️ 手动 | ✅ | ✅ 高 | ⭐⭐ 中等 |
| 文件时间戳 | ⚠️ 需切换 | ✅ | ✅ 高 | ⭐⭐ 中等 |

## 🎨 Obsidian 排序设置

### 确保文件按名称排序

在 Obsidian 文件浏览器中：

1. 点击文件夹右上角的 **...** 菜单
2. 选择 **Sort by** → **File name (A to Z)**

这样新同步的文章会自动按日期倒序显示（因为 `2026-02-07` > `2026-02-06`）。

## 🔄 与现有文件的兼容性

### 旧文件（无日期前缀）

- 会排在所有新文件之后
- 不影响插件功能
- 可以手动重命名添加日期

### 手动清理旧文件

如果想统一格式，可以批量重命名旧文件：

```bash
# 示例：给旧文件添加日期前缀
cd "/Users/ray/Obsidian/00_Inbox/00_RSS_News/深度科技与极客文化"

# 手动或使用脚本重命名
mv "Why I Joined OpenAI.md" "2026-02-07 Why I Joined OpenAI.md"
```

## ⚡ 性能影响

- **日期解析**: 每篇文章增加 < 1ms 处理时间
- **文件创建**: 无影响
- **整体性能**: 可忽略不计

## 🛠️ 自定义选项

### 如果想使用其他日期格式

修改 `Feeds.ts` 中的日期格式化代码：

**格式选项**:

```typescript
// YYYYMMDD (无分隔符)
datePrefix = `${year}${month}${day} `;
// 示例: "20260207 Why I Joined OpenAI.md"

// YYYY.MM.DD (点分隔)
datePrefix = `${year}.${month}.${day} `;
// 示例: "2026.02.07 Why I Joined OpenAI.md"

// MM-DD (只保留月日)
datePrefix = `${month}-${day} `;
// 示例: "02-07 Why I Joined OpenAI.md"
```

### 如果想禁用日期前缀

注释掉或删除整个日期前缀逻辑即可：

```typescript
// let datePrefix = "";  // 注释掉这一行
const datePrefix = "";  // 直接设为空字符串
```

## 📝 后续优化建议

### 1. 添加配置选项

可以在设置页面添加开关：

- [ ] 启用/禁用日期前缀
- [ ] 自定义日期格式
- [ ] 选择日期来源（isoDate/pubDate/自定义）

### 2. 支持时间戳

对于一天内多篇文章，可以添加时间：

```typescript
datePrefix = `${year}-${month}-${day} ${hours}${minutes} `;
// 示例: "2026-02-07 1430 Why I Joined OpenAI.md"
```

### 3. 智能去重

如果同一天有同标题文章，自动添加序号：

```typescript
// 2026-02-07 Why I Joined OpenAI.md
// 2026-02-07 Why I Joined OpenAI (2).md
```

## 🎉 实施效果

### 预期结果

1. ✅ 新同步的 RSS 文章自动按日期倒序排列
2. ✅ 最新文章始终在文件夹顶部
3. ✅ 文件名即可看到发布日期
4. ✅ 无需手动操作或额外插件

### 用户体验

- 📁 打开文件夹，最新文章一目了然
- 🔍 搜索时可以按日期快速定位
- 📊 历史文章按时间轴自然排列
- ⚡ 零学习成本，开箱即用

## 🚀 使用指南

### 第一次使用

1. **重启 Obsidian** (`Cmd + R`)
2. **点击 RSS 同步按钮**
3. **检查新文章** - 文件名应该有日期前缀
4. **确认文件夹排序** - 设置为按文件名排序

### 日常使用

- 正常同步即可，无需额外操作
- 新文章自动添加日期前缀
- 自动按时间倒序排列

### 故障排查

如果文件名没有日期前缀：

1. 检查 RSS 源是否提供日期字段
2. 查看控制台是否有日期解析警告
3. 验证 `item.isoDate` 或 `item.pubDate` 是否存在

## 📌 注意事项

1. **旧文件不会自动更新** - 只影响新同步的文章
2. **RSS 源必须提供日期** - 否则无法添加前缀
3. **文件名长度** - 日期前缀会增加 11 个字符（`YYYY-MM-DD`）
4. **排序设置** - 确保 Obsidian 按文件名排序

## 🔗 相关资源

- [Obsidian 文件排序文档](https://help.obsidian.md/Files+and+folders/Manage+files)
- [RSS pubDate 规范](https://www.rssboard.org/rss-specification#ltpubdategtSubelementOfLtitemgt)
- [ISO 8601 日期格式](https://en.wikipedia.org/wiki/ISO_8601)

---

**实施完成** ✅  
现在您的 RSS 文章会自动按时间倒序排列！
